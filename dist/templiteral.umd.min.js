(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports):typeof define==="function"&&define.amd?define(["exports"],t):t(e.templit={})})(this,function(e){"use strict";const t=/---!\{.*\}!---/gi;const s=/^\(.*\)$/gi;const n=/^\[.*\]$/;const i=/^this\./;const o=/---!\{/gi;const a=/\}!---/gi;class l{constructor(e){this.node=e;this.base=e.nodeValue||"";this.index=+this.base.match(t)[0].replace(o,"").replace(a,"")}set value(e){const s=this.base.replace(t,e);this.value!==s?this.node.nodeValue=s:null}get value(){return this.node.nodeValue}setValue(e=""){this.node.nodeValue=this.base.replace(t,e)}update(e){this.value=e[this.index]}}class c{constructor(e,t,s,n,i){this.node=e;this.boundAttrs=t;this.boundEvents=s;this.context=n;this.index=i;this.boundAttrs.forEach(e=>e.base=e.value);this.addListeners()}addListeners(){this.boundEvents.forEach((e,t)=>{const s=e.split(/;/);const n=s.filter(e=>e.match(i));const o=n.join("; ");if(e.match(i)){const e=new Function(o).bind(this.context);this.node.addEventListener(t,e);this.node._boundEvents=e}if(n.length<s.length){console.warn("Inline functions not allowed inside of event bindings. Unsafe functions have been removed from node",this.node)}})}cleanUp(){this.boundAttrs.forEach(e=>e.value=e.value.replace(o,"").replace(a,""))}updateAttributes(e,t){const s=e.slice(1,-1);if(t.value){this.node[s]=t.value;this.node.setAttribute(s,t.value)}else{this.node.removeAttribute(s)}}updateProperty(e,t){const s=e.name.replace(/\[|\]/g,"");this.node[s]=t;if(t&&t!=="false"){this.node.setAttribute(s,t)}else{this.node.removeAttribute(s)}}update(e){this.boundAttrs.forEach(t=>{const s=t.base.match(/---!{*.}!---/g)||[];const i=s.map(e=>+e.replace("---!{","").replace("}!---",""));let o=t.base;for(let t=0;t<i.length;t+=1){const s=e[i[t]];o=o.replace(`---!{${i[t]}}!---`,s)}t.value=o;if(t.name.match(n)){this.updateProperty(t,o)}})}}class h{constructor(e,t,s,n){this.strings=e;this.values=t;this.oldValues=t.map((e,t)=>`---!{${t}}!---`);this.location=s;this.context=n;this.parts=[];this.templiteralParts=new Set;this.eventHandlers=[];this._init()}_append(e){this.parts.forEach((e,t)=>{if(e instanceof l){e.setValue(this.values[t],this.oldValues[t])}else if(e instanceof c){e.update(this.values,this.oldValues)}});this.location.appendChild(e)}_init(){const e=this.strings.map((e,t)=>`${e?e:""}${this.values[t]!==undefined?"---!{"+t+"}!---":""}`).join("");const t=document.createElement("template");t.innerHTML=e;const s=document.importNode(t.content,true);const n=document.createTreeWalker(s,133,null,false);this._walk(n,this.parts,true);this._append(s)}_walk(e,i,o){let a=-1;while(e.nextNode()){const{currentNode:h}=e;if(!h.__templiteralCompiler){switch(h.nodeType){case 1:{const{attributes:e}=h;if(e.length){const l=new Map;const r=new Map;for(let i=0;i<e.length;i+=1){const a=e[i];if(a.value.match(t)||a.name.match(n)){l.set(a.name,a)}if(o&&a.name.match(s)){const e=a.name.substring(1,a.name.length-1);r.set(e,a.value);this.eventHandlers.push({eventName:e,currentNode:h})}}if(l.size>=1||r.size>=1){a+=1;const e=new c(h,l,r,this.context,a);i.push(e)}}break}case 3:{a+=1;if(h.textContent&&h.textContent.match(t)){a+=1;const e=new l(h,a);i.push(e)}break}}}else{this.templiteralParts.add(h)}}return i}update(e){this.oldValues=this.values;this.values=e;this.parts.forEach(t=>{t.update(e,this.oldValues)})}}const r=new Map;function u(e=this,t=this){e.shadowRoot?e=e.shadowRoot:null;return(s,...n)=>{const i=btoa(s.join(""));let o=r.get(i);if(o){o.update(n)}else{o=new h(s,n,e,t);r.set(i,o)}}}function d(e){e.forEach(e=>customElements.define(e.tagName,e))}e.templiteral=u;e.registerElements=d;Object.defineProperty(e,"__esModule",{value:true})});
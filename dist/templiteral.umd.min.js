(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports):typeof define==="function"&&define.amd?define(["exports"],e):e(t.templit={})})(this,function(t){"use strict";const e=/---!\{.*\}!---/gi;const n=/^\(.*\)$/gi;const s=/^\[.*\]$/;const o=/^this\./;const i=/---!\{/gi;const a=/\}!---/gi;class c{constructor(t,e){this.node=t;this.index=e}cleanUp(){this.node.textContent=this.node.textContent.replace(i,"").replace(a,"")}update(t){if(this.node.nodeValue!==t.node.nodeValue){this.node.nodeValue=t.node.nodeValue}}}class r{constructor(t,e,n,s,o){this.node=t;this.index=e;this.boundAttrs=n;this.boundEvents=s;this.context=o;this.addListeners()}addListeners(){this.boundEvents.forEach((t,e)=>{const n=t.split(/\;/);const s=n.filter(t=>t.match(o));const i=s.join("; ");if(t.match(o)){const t=new Function(i);this.node.addEventListener(e,t.bind(this.context))}if(s.length<n.length){console.warn("Inline functions not allowed inside of event bindings. Unsafe functions have been removed from node",this.node)}})}cleanUp(){this.boundAttrs.forEach(t=>t.value=t.value.replace(i,"").replace(a,""))}update(t){this.boundAttrs.forEach(e=>{const n=t.boundAttrs.get(e.name);n&&e.value!==n.value?e.value=n.value:null;if(e.name.match(s)){this.updateAttributes(e.name,n)}})}updateAttributes(t,e){const n=t.slice(1,-1);if(e.value){this.node[n]=e.value;this.node.setAttribute(n,e.value)}else{this.node;this.node.removeAttribute(n)}}}class l{constructor(t,e,n){const s=document.createElement("template");const o=t.replace(i,"").replace(a,"");s.innerHTML=o;this.node=document.importNode(s.content,true);this.parts=new Map;this.eventHandlers=[];this.location=e;this.context=n;this._init(t)}paint(){this.location.appendChild(this.node)}update(t){const e=document.createElement("template");e.innerHTML=t;const n=document.importNode(e.content,true);const s=document.createTreeWalker(n,133,null,false);this._parseUpdates(s)}_parseUpdates(t){const e=this._walk(t,new Map);this.parts.forEach((t,n)=>t.update(e.get(n)))}_init(t){const e=document.createElement("template");e.innerHTML=t;const n=document.importNode(e.content,true);const s=document.createTreeWalker(n,133,null,false);this._walk(s,this.parts);this.node=n;this.paint()}_walk(t,o){let i=-1;while(t.nextNode()){i+=1;const{currentNode:a}=t;switch(a.nodeType){case 1:{const{attributes:t}=a;if(t.length){const c=new Map;const l=new Map;for(let o=0;o<t.length;o+=1){const i=t[o];if(i.value.match(e)||i.name.match(s)){c.set(i.name,i)}if(i.name.match(n)){const t=i.name.substring(1,i.name.length-1);l.set(t,i.value);this.eventHandlers.push({eventName:t,currentNode:a})}}if(c.size>=1||l.size>=1||this.parts.has(i)){const t=new r(a,i,c,l,this.context);o.set(i,t);t.cleanUp()}}break}case 3:{if(a.textContent&&a.textContent.match(e)||this.parts.has(i)){const t=new c(a,i);o.set(i,t);t.cleanUp()}break}}}return o}}const d=new Map;function u(t){return function(e,...n){const s=e.map((t,e)=>`${t?t:""}${n[e]?"---!{"+n[e]+"}!---":""}`).join("");const o=btoa(e.join(""));let i=d.get(o);if(i){i.update(s)}else{i=new l(s,t,this);d.set(o,i)}}}function h(t,e){function n(...n){const s=Reflect.apply(u,e,[t]);return Reflect.apply(s,e,n)}return n.bind(e)}t.templiteral=h;Object.defineProperty(t,"__esModule",{value:true})});